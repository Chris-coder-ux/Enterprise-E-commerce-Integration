<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>core/EventManager.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AjaxManager.html">AjaxManager</a><ul class='methods'><li data-type='method'><a href="AjaxManager.html#.call">call</a></li></ul></li><li><a href="ErrorHandler.html">ErrorHandler</a><ul class='methods'><li data-type='method'><a href="ErrorHandler.html#.logError">logError</a></li><li data-type='method'><a href="ErrorHandler.html#.showCancelError">showCancelError</a></li><li data-type='method'><a href="ErrorHandler.html#.showConnectionError">showConnectionError</a></li><li data-type='method'><a href="ErrorHandler.html#.showCriticalError">showCriticalError</a></li><li data-type='method'><a href="ErrorHandler.html#.showProtectionError">showProtectionError</a></li><li data-type='method'><a href="ErrorHandler.html#.showUIError">showUIError</a></li></ul></li><li><a href="EventCleanupManager.html">EventCleanupManager</a><ul class='methods'><li data-type='method'><a href="EventCleanupManager.html#cleanupAll">cleanupAll</a></li><li data-type='method'><a href="EventCleanupManager.html#getStats">getStats</a></li><li data-type='method'><a href="EventCleanupManager.html#.cleanupComponent">cleanupComponent</a></li><li data-type='method'><a href="EventCleanupManager.html#.getInstance">getInstance</a></li><li data-type='method'><a href="EventCleanupManager.html#.registerCustomEventListener">registerCustomEventListener</a></li><li data-type='method'><a href="EventCleanupManager.html#.registerDocumentListener">registerDocumentListener</a></li><li data-type='method'><a href="EventCleanupManager.html#.registerElementListener">registerElementListener</a></li><li data-type='method'><a href="EventCleanupManager.html#.registerNativeListener">registerNativeListener</a></li></ul></li><li></li><li></li><li><a href="PollingManager.html">PollingManager</a><ul class='methods'><li data-type='method'><a href="PollingManager.html#adjustPolling">adjustPolling</a></li><li data-type='method'><a href="PollingManager.html#emit">emit</a></li><li data-type='method'><a href="PollingManager.html#getIntervalId">getIntervalId</a></li><li data-type='method'><a href="PollingManager.html#isPollingActive">isPollingActive</a></li><li data-type='method'><a href="PollingManager.html#off">off</a></li><li data-type='method'><a href="PollingManager.html#on">on</a></li><li data-type='method'><a href="PollingManager.html#recordError">recordError</a></li><li data-type='method'><a href="PollingManager.html#recordResponseTime">recordResponseTime</a></li><li data-type='method'><a href="PollingManager.html#reset">reset</a></li><li data-type='method'><a href="PollingManager.html#startPolling">startPolling</a></li><li data-type='method'><a href="PollingManager.html#stopAllPolling">stopAllPolling</a></li><li data-type='method'><a href="PollingManager.html#stopPolling">stopPolling</a></li></ul></li><li></li><li></li><li><a href="SyncDashboard.html">SyncDashboard</a><ul class='methods'><li data-type='method'><a href="SyncDashboard.html#cancelPhase1">cancelPhase1</a></li><li data-type='method'><a href="SyncDashboard.html#cancelSync">cancelSync</a></li><li data-type='method'><a href="SyncDashboard.html#disableButton">disableButton</a></li><li data-type='method'><a href="SyncDashboard.html#enableButton">enableButton</a></li><li data-type='method'><a href="SyncDashboard.html#handlePhase1Response">handlePhase1Response</a></li><li data-type='method'><a href="SyncDashboard.html#loadCurrentStatus">loadCurrentStatus</a></li><li data-type='method'><a href="SyncDashboard.html#pausePhase2">pausePhase2</a></li><li data-type='method'><a href="SyncDashboard.html#resumePhase1">resumePhase1</a></li><li data-type='method'><a href="SyncDashboard.html#startPhase1">startPhase1</a></li><li data-type='method'><a href="SyncDashboard.html#startPhase2">startPhase2</a></li><li data-type='method'><a href="SyncDashboard.html#startTimer">startTimer</a></li><li data-type='method'><a href="SyncDashboard.html#stopTimer">stopTimer</a></li><li data-type='method'><a href="SyncDashboard.html#updateConfig">updateConfig</a></li><li data-type='method'><a href="SyncDashboard.html#updateDashboardFromStatus">updateDashboardFromStatus</a></li><li data-type='method'><a href="SyncDashboard.html#updatePhase1Progress">updatePhase1Progress</a></li><li data-type='method'><a href="SyncDashboard.html#updatePhase2Progress">updatePhase2Progress</a></li><li data-type='method'><a href="SyncDashboard.html#updatePhaseStatus">updatePhaseStatus</a></li></ul></li><li></li><li></li><li><a href="UIOptimizer.html">UIOptimizer</a><ul class='methods'><li data-type='method'><a href="UIOptimizer.html#cancelPendingUpdates">cancelPendingUpdates</a></li><li data-type='method'><a href="UIOptimizer.html#clearCache">clearCache</a></li><li data-type='method'><a href="UIOptimizer.html#scheduleUpdate">scheduleUpdate</a></li><li data-type='method'><a href="UIOptimizer.html#.getInstance">getInstance</a></li><li data-type='method'><a href="UIOptimizer.html#.updateCssIfChanged">updateCssIfChanged</a></li><li data-type='method'><a href="UIOptimizer.html#.updateDataIfChanged">updateDataIfChanged</a></li><li data-type='method'><a href="UIOptimizer.html#.updateHtmlIfChanged">updateHtmlIfChanged</a></li><li data-type='method'><a href="UIOptimizer.html#.updateTextIfChanged">updateTextIfChanged</a></li><li data-type='method'><a href="UIOptimizer.html#.updateValueIfChanged">updateValueIfChanged</a></li></ul></li><li></li><li></li></ul><h3>Modules</h3><ul><li><a href="module-ui_SidebarController.html">ui/SidebarController</a></li><li><a href="module-utils_FormatUtils.html">utils/FormatUtils</a></li></ul><h3>Namespaces</h3><ul><li></li><li><a href="CardManager.html">CardManager</a></li><li></li><li><a href="ConsoleManager.html">ConsoleManager</a></li><li><a href="DASHBOARD_CONFIG.html">DASHBOARD_CONFIG</a></li><li></li><li><a href="global.html#DomUtils">DomUtils</a></li><li></li><li><a href="MESSAGES.html">MESSAGES</a></li><li><a href="global.html#NonceManager">NonceManager</a></li><li><a href="global.html#Phase1Manager">Phase1Manager</a></li><li><a href="global.html#Phase2Manager">Phase2Manager</a></li><li><a href="global.html#ProgressBar">ProgressBar</a></li><li><a href="ResponsiveLayout.html">ResponsiveLayout</a></li><li></li><li><a href="SELECTORS.html">SELECTORS</a></li><li></li><li><a href="global.html#Sanitizer">Sanitizer</a><ul class='methods'><li data-type='method'><a href="global.html#Sanitizer#.escapeHtml">escapeHtml</a></li><li data-type='method'><a href="global.html#Sanitizer#.sanitizeHtml">sanitizeHtml</a></li><li data-type='method'><a href="global.html#Sanitizer#.sanitizeMessage">sanitizeMessage</a></li></ul></li><li><a href="global.html#SyncController">SyncController</a></li><li><a href="global.html#SyncProgress">SyncProgress</a></li><li><a href="global.html#SyncStateManager">SyncStateManager</a></li><li><a href="global.html#SystemEventManager">SystemEventManager</a><ul class='methods'><li data-type='method'><a href="global.html#SystemEventManager#.checkAllSystemsReady">checkAllSystemsReady</a></li><li data-type='method'><a href="global.html#SystemEventManager#.checkDependencies">checkDependencies</a></li><li data-type='method'><a href="global.html#SystemEventManager#.emitErrorHandlerReady">emitErrorHandlerReady</a></li><li data-type='method'><a href="global.html#SystemEventManager#.emitSystemBaseReady">emitSystemBaseReady</a></li><li data-type='method'><a href="global.html#SystemEventManager#.emitUnifiedDashboardReady">emitUnifiedDashboardReady</a></li><li data-type='method'><a href="global.html#SystemEventManager#.getInitializationState">getInitializationState</a></li><li data-type='method'><a href="global.html#SystemEventManager#.init">init</a></li><li data-type='method'><a href="global.html#SystemEventManager#.initializeSystem">initializeSystem</a></li><li data-type='method'><a href="global.html#SystemEventManager#.log">log</a></li><li data-type='method'><a href="global.html#SystemEventManager#.registerSystem">registerSystem</a></li></ul></li><li><a href="global.html#ToastManager">ToastManager</a></li><li><a href="UnifiedDashboard.html">UnifiedDashboard</a><ul class='methods'><li data-type='method'><a href="UnifiedDashboard.html#.init">init</a></li><li data-type='method'><a href="UnifiedDashboard.html#.toggleDebugMode">toggleDebugMode</a></li></ul></li><li></li><li><a href="UnifiedDashboardController.html">UnifiedDashboardController</a></li><li></li></ul><h3>Global</h3><ul><li><a href="global.html#DEFAULT_DURATION">DEFAULT_DURATION</a></li><li><a href="global.html#DEFAULT_RENEWAL_INTERVAL">DEFAULT_RENEWAL_INTERVAL</a></li><li><a href="global.html#DEFAULT_SELECTOR">DEFAULT_SELECTOR</a></li><li><a href="global.html#DOM_CACHE">DOM_CACHE</a></li><li><a href="global.html#TOAST_CLASSES">TOAST_CLASSES</a></li><li><a href="global.html#TOAST_COLORS">TOAST_COLORS</a></li><li><a href="global.html#TOAST_ICONS">TOAST_ICONS</a></li><li><a href="global.html#adjustLayout">adjustLayout</a></li><li><a href="global.html#attemptRenewal">attemptRenewal</a></li><li><a href="global.html#check">check</a></li><li><a href="global.html#cleanupOnPageLoad">cleanupOnPageLoad</a></li><li><a href="global.html#cleanupSyncProgressListeners">cleanupSyncProgressListeners</a></li><li><a href="global.html#clearPhase2PollingInterval">clearPhase2PollingInterval</a></li><li><a href="global.html#clearSyncInterval">clearSyncInterval</a></li><li><a href="global.html#error">error</a></li><li><a href="global.html#getCache">getCache</a></li><li><a href="global.html#getFadeInDuration">getFadeInDuration</a></li><li><a href="global.html#getInactiveProgressCounter">getInactiveProgressCounter</a></li><li><a href="global.html#getLastProgressValue">getLastProgressValue</a></li><li><a href="global.html#getPhase1Initialized">getPhase1Initialized</a></li><li><a href="global.html#getPhase1Starting">getPhase1Starting</a></li><li><a href="global.html#getPhase2Initialized">getPhase2Initialized</a></li><li><a href="global.html#getPhase2PollingInterval">getPhase2PollingInterval</a></li><li><a href="global.html#getPhase2ProcessingBatch">getPhase2ProcessingBatch</a></li><li><a href="global.html#getPhase2Starting">getPhase2Starting</a></li><li><a href="global.html#getPollingInterval">getPollingInterval</a></li><li><a href="global.html#getState">getState</a></li><li><a href="global.html#getSyncInterval">getSyncInterval</a></li><li><a href="global.html#getTrackingState">getTrackingState</a></li><li><a href="global.html#getWidth">getWidth</a></li><li><a href="global.html#hideSidebar">hideSidebar</a></li><li><a href="global.html#inactiveProgressCounter">inactiveProgressCounter</a></li><li><a href="global.html#incrementInactiveProgressCounter">incrementInactiveProgressCounter</a></li><li><a href="global.html#info">info</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initCache">initCache</a></li><li><a href="global.html#initResponsiveMenu">initResponsiveMenu</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#initializeSyncDashboard">initializeSyncDashboard</a></li><li><a href="global.html#isAutoRenewalActive">isAutoRenewalActive</a></li><li><a href="global.html#isAvailable">isAvailable</a></li><li><a href="global.html#isCacheInitialized">isCacheInitialized</a></li><li><a href="global.html#isComplete">isComplete</a></li><li><a href="global.html#isPollingActive">isPollingActive</a></li><li><a href="global.html#phase1Starting">phase1Starting</a></li><li><a href="global.html#phase2Starting">phase2Starting</a></li><li><a href="global.html#pollingManager">pollingManager</a></li><li><a href="global.html#proceedWithSync">proceedWithSync</a></li><li><a href="global.html#processNextBatchAutomatically">processNextBatchAutomatically</a></li><li><a href="global.html#refreshCache">refreshCache</a></li><li><a href="global.html#reinit">reinit</a></li><li><a href="global.html#renewalIntervalId">renewalIntervalId</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#resetAllState">resetAllState</a></li><li><a href="global.html#resetCounters">resetCounters</a></li><li><a href="global.html#resetPhase1State">resetPhase1State</a></li><li><a href="global.html#resetPhase2State">resetPhase2State</a></li><li><a href="global.html#setColor">setColor</a></li><li><a href="global.html#setInactiveProgressCounter">setInactiveProgressCounter</a></li><li><a href="global.html#setLastProgressValue">setLastProgressValue</a></li><li><a href="global.html#setPercentage">setPercentage</a></li><li><a href="global.html#setPhase1Initialized">setPhase1Initialized</a></li><li><a href="global.html#setPhase1Starting">setPhase1Starting</a></li><li><a href="global.html#setPhase2Initialized">setPhase2Initialized</a></li><li><a href="global.html#setPhase2PollingInterval">setPhase2PollingInterval</a></li><li><a href="global.html#setPhase2ProcessingBatch">setPhase2ProcessingBatch</a></li><li><a href="global.html#setPhase2Starting">setPhase2Starting</a></li><li><a href="global.html#setSyncInterval">setSyncInterval</a></li><li><a href="global.html#setWidth">setWidth</a></li><li><a href="global.html#setupAutoRenewal">setupAutoRenewal</a></li><li><a href="global.html#show">show</a></li><li><a href="global.html#showSidebar">showSidebar</a></li><li><a href="global.html#start">start</a></li><li><a href="global.html#stop">stop</a></li><li><a href="global.html#stopAutoRenewal">stopAutoRenewal</a></li><li><a href="global.html#stopProgressPolling">stopProgressPolling</a></li><li><a href="global.html#success">success</a></li><li><a href="global.html#toggleSidebar">toggleSidebar</a></li><li><a href="global.html#trackingState">trackingState</a></li><li><a href="global.html#updateCardData">updateCardData</a></li><li><a href="global.html#updateSpecificCard">updateSpecificCard</a></li><li><a href="global.html#warning">warning</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">core/EventManager.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * EventManager - Gestión de Eventos del Sistema
 * 
 * Coordinación de inicialización de sistemas externos mediante eventos personalizados.
 * Gestiona el estado de inicialización y emite eventos cuando los sistemas están listos.
 * 
 * @module core/EventManager
 * @class EventManager
 * @namespace SystemEventManager
 * @description Coordinación de inicialización de sistemas externos
 * @since 1.0.0
 * @author Christian
 * 
 * @example
 * // Inicializar sistema de eventos
 * SystemEventManager.init();
 * 
 * // Registrar un sistema
 * SystemEventManager.registerSystem('miSistema', ['jQuery'], function() {
 *   console.log('Sistema inicializado');
 * });
 * 
 * // Escuchar eventos
 * window.addEventListener('mi-system-base-ready', function(event) {
 *   console.log('Sistema base listo', event.detail);
 * });
 */

/* global window, ErrorHandler, AjaxManager */

/**
 * Polyfill para Object.assign (compatibilidad con IE11 y navegadores antiguos)
 * 
 * WordPress puede ejecutarse en navegadores antiguos que no soportan Object.assign nativamente.
 * Este polyfill garantiza compatibilidad total.
 * 
 * Nota: Usamos 'var' intencionalmente para compatibilidad con IE11 que no soporta let/const.
 * 
 * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign
 */
if (typeof Object.assign !== 'function') {
  // eslint-disable-next-line no-var
  Object.assign = function(target) {
    'use strict';
    if (target == null) {
      throw new TypeError('Cannot convert undefined or null to object');
    }
    
    // eslint-disable-next-line no-var
    var to = Object(target);
    // eslint-disable-next-line no-var
    for (var index = 1; index &lt; arguments.length; index++) {
      // eslint-disable-next-line no-var
      var nextSource = arguments[index];
      if (nextSource != null) {
        // eslint-disable-next-line no-var
        for (var nextKey in nextSource) {
          if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
            to[nextKey] = nextSource[nextKey];
          }
        }
      }
    }
    return to;
  };
}

/**
 * Clase para gestión de eventos del sistema
 * 
 * Esta clase proporciona métodos para:
 * - Gestionar el estado de inicialización de sistemas
 * - Emitir eventos personalizados cuando los sistemas están listos
 * - Registrar y verificar dependencias de sistemas externos
 * - Coordinar la inicialización ordenada de componentes
 */
const SystemEventManager = {
  /**
   * Estado de inicialización de los sistemas
   * 
   * @type {Object}
   * @property {boolean} systemBase - Sistema base listo
   * @property {boolean} errorHandler - ErrorHandler listo
   * @property {boolean} unifiedDashboard - UnifiedDashboard listo
   * @property {boolean} allSystems - Todos los sistemas listos
   */
  initializationState: {
    systemBase: false,
    errorHandler: false,
    unifiedDashboard: false,
    allSystems: false
  },
  
  /**
   * Lista de sistemas registrados
   * 
   * @type {Map&lt;string, Object>}
   * @property {Array} dependencies - Dependencias del sistema
   * @property {Function} callback - Callback de inicialización
   * @property {boolean} initialized - Estado de inicialización
   */
  registeredSystems: new Map(),
  
  /**
   * Inicializar el sistema de eventos
   * 
   * Emite el evento inicial de sistema base listo.
   * 
   * @returns {void}
   * @example
   * SystemEventManager.init();
   */
  init() {
    this.log('Sistema de eventos inicializado');
    this.emitSystemBaseReady();
  },
  
  /**
   * Emitir evento de sistema base listo
   * 
   * Marca el sistema base como listo y emite el evento 'mi-system-base-ready'
   * con información sobre los sistemas disponibles.
   * 
   * @returns {void}
   * @example
   * SystemEventManager.emitSystemBaseReady();
   */
  emitSystemBaseReady() {
    this.initializationState.systemBase = true;
    this.log('Sistema base listo - emitiendo evento');
    window.dispatchEvent(new CustomEvent('mi-system-base-ready', {
      detail: {
        timestamp: Date.now(),
        systems: {
          // eslint-disable-next-line no-undef
          errorHandler: typeof ErrorHandler !== 'undefined',
          // eslint-disable-next-line no-undef
          ajaxManager: typeof AjaxManager !== 'undefined',
          pollingManager: window.PollingManager !== undefined
        }
      }
    }));
  },
  
  /**
   * Emitir evento de ErrorHandler listo
   * 
   * Marca ErrorHandler como listo y emite el evento 'mi-error-handler-ready'.
   * 
   * @returns {void}
   * @example
   * SystemEventManager.emitErrorHandlerReady();
   */
  emitErrorHandlerReady() {
    this.initializationState.errorHandler = true;
    this.log('ErrorHandler listo - emitiendo evento');
    window.dispatchEvent(new CustomEvent('mi-error-handler-ready', {
      detail: {
        timestamp: Date.now(),
        // eslint-disable-next-line no-undef
        errorHandler: typeof ErrorHandler !== 'undefined'
      }
    }));
  },
  
  /**
   * Emitir evento de UnifiedDashboard listo
   * 
   * Marca UnifiedDashboard como listo y emite el evento 'mi-unified-dashboard-ready'.
   * Verifica si todos los sistemas están listos después de emitir el evento.
   * 
   * @returns {void}
   * @example
   * SystemEventManager.emitUnifiedDashboardReady();
   */
  emitUnifiedDashboardReady() {
    this.initializationState.unifiedDashboard = true;
    this.log('UnifiedDashboard listo - emitiendo evento');
    window.dispatchEvent(new CustomEvent('mi-unified-dashboard-ready', {
      detail: {
        timestamp: Date.now(),
        unifiedDashboard: window.UnifiedDashboard !== undefined
      }
    }));
    
    // Verificar si todos los sistemas están listos
    this.checkAllSystemsReady();
  },
  
  /**
   * Verificar si todos los sistemas están listos
   * 
   * Comprueba si todos los sistemas han sido inicializados y emite
   * el evento 'mi-all-systems-ready' si es la primera vez que todos están listos.
   * 
   * @returns {void}
   * @example
   * SystemEventManager.checkAllSystemsReady();
   */
  checkAllSystemsReady() {
    // Verificar que todos los estados excepto allSystems sean true
    const states = this.initializationState;
    const allReady = states.systemBase === true &amp;&amp;
                     states.errorHandler === true &amp;&amp;
                     states.unifiedDashboard === true;
    
    if (allReady &amp;&amp; !states.allSystems) {
      states.allSystems = true;
      this.log('Todos los sistemas listos - emitiendo evento final');
      window.dispatchEvent(new CustomEvent('mi-all-systems-ready', {
        detail: {
          timestamp: Date.now(),
          initializationState: Object.assign({}, this.initializationState)
        }
      }));
    }
  },
  
  /**
   * Registrar un sistema externo
   * 
   * Registra un sistema con sus dependencias y callback de inicialización.
   * 
   * @param {string} systemName - Nombre del sistema a registrar
   * @param {Array&lt;string|Function>} dependencies - Array de dependencias (strings o funciones)
   * @param {Function} callback - Callback a ejecutar cuando el sistema se inicialice
   * @returns {void}
   * @example
   * SystemEventManager.registerSystem('miSistema', ['jQuery', 'ErrorHandler'], function() {
   *   console.log('Sistema inicializado');
   * });
   */
  registerSystem(systemName, dependencies, callback) {
    this.registeredSystems.set(systemName, {
      dependencies,
      callback,
      initialized: false
    });
    this.log('Sistema registrado: ' + systemName);
  },
  
  /**
   * Verificar dependencias de un sistema
   * 
   * Comprueba si todas las dependencias de un sistema están disponibles.
   * 
   * @param {string} systemName - Nombre del sistema a verificar
   * @returns {boolean} true si todas las dependencias están disponibles, false en caso contrario
   * @example
   * if (SystemEventManager.checkDependencies('miSistema')) {
   *   console.log('Todas las dependencias están disponibles');
   * }
   */
  checkDependencies(systemName) {
    const system = this.registeredSystems.get(systemName);
    if (!system) {
      this.log('Sistema no encontrado: ' + systemName, 'error');
      return false;
    }
    
    const dependencies = system.dependencies;
    const available = dependencies.every(function(dep) {
      if (typeof dep === 'string') {
        // Usar typeof para evitar ReferenceError si la propiedad no existe
        // eslint-disable-next-line no-undef
        return typeof window[dep] !== 'undefined';
      } else if (typeof dep === 'function') {
        return dep();
      }
      return false;
    });
    
    this.log('Dependencias de ' + systemName + ': ' + (available ? 'disponibles' : 'faltantes'));
    return available;
  },
  
  /**
   * Inicializar un sistema si sus dependencias están disponibles
   * 
   * Verifica las dependencias y ejecuta el callback de inicialización si están disponibles.
   * 
   * @param {string} systemName - Nombre del sistema a inicializar
   * @returns {boolean} true si el sistema se inicializó correctamente, false en caso contrario
   * @example
   * if (SystemEventManager.initializeSystem('miSistema')) {
   *   console.log('Sistema inicializado correctamente');
   * }
   */
  initializeSystem(systemName) {
    const system = this.registeredSystems.get(systemName);
    if (!system || system.initialized) {
      return false;
    }
    
    if (this.checkDependencies(systemName)) {
      try {
        system.callback();
        system.initialized = true;
        this.log('Sistema inicializado: ' + systemName);
        return true;
      } catch (error) {
        // ✅ MEJORADO: Registrar error usando ErrorHandler además del log interno
        if (typeof ErrorHandler !== 'undefined' &amp;&amp; ErrorHandler &amp;&amp; typeof ErrorHandler.logError === 'function') {
          ErrorHandler.logError(
            `Error al inicializar sistema '${systemName}': ${error.message || error}`,
            'SYSTEM_INIT'
          );
        }
        this.log('Error al inicializar sistema ' + systemName + ':', 'error', error);
        return false;
      }
    }
    
    return false;
  },
  
  /**
   * Obtener estado de inicialización
   * 
   * Retorna un objeto con el estado completo de inicialización, incluyendo
   * los sistemas registrados y sus detalles.
   * 
   * @returns {Object} Estado de inicialización completo
   * @example
   * const state = SystemEventManager.getInitializationState();
   * console.log('Sistemas registrados:', state.registeredSystems);
   */
  getInitializationState() {
    // eslint-disable-next-line prefer-object-spread
    return Object.assign({}, this.initializationState, {
      registeredSystems: Array.from(this.registeredSystems.keys()),
      systemDetails: Object.fromEntries(
        Array.from(this.registeredSystems.entries()).map(function(entry) {
          const name = entry[0];
          const system = entry[1];
          return [
            name,
            { initialized: system.initialized, dependencies: system.dependencies }
          ];
        })
      )
    });
  },
  
  /**
   * Logging del sistema de eventos
   * 
   * Registra mensajes con timestamp y nivel de log.
   * 
   * @param {string} message - Mensaje a registrar
   * @param {string} [level='info'] - Nivel de log ('info', 'warn', 'error')
   * @param {*} [data=null] - Datos adicionales a registrar
   * @returns {void}
   * @example
   * SystemEventManager.log('Mensaje informativo');
   * SystemEventManager.log('Advertencia', 'warn');
   * SystemEventManager.log('Error', 'error', errorObject);
   */
  log(message, level, data) {
    if (level === undefined) {
      level = 'info';
    }
    if (data === undefined) {
      data = null;
    }
    
    const timestamp = new Date().toISOString();
    const logMessage = '[SystemEventManager ' + timestamp + '] ' + message;
    
    if (level === 'error') {
      // eslint-disable-next-line no-console
      console.error(logMessage, data);
    } else if (level === 'warn') {
      // eslint-disable-next-line no-console
      console.warn(logMessage, data);
    } else {
      // eslint-disable-next-line no-console
      console.log(logMessage, data);
    }
  }
};

// ========================================
// EXPOSICIÓN GLOBAL
// ========================================

/**
 * Exponer SystemEventManager globalmente para mantener compatibilidad
 * con el código existente que usa window.SystemEventManager
 * 
 * NOTA: En el archivo original (dashboard.js línea 4819) se expone como:
 * window.SystemEventManager = SystemEventManager
 * 
 * Mantenemos la misma lógica para compatibilidad exacta.
 */
if (typeof window !== 'undefined') {
  // ✅ SEGURIDAD: Método 1: Asignación directa dentro de try...catch
  try {
    window.SystemEventManager = SystemEventManager;
    if (window.SystemEventManager === SystemEventManager) {
      // ✅ Éxito, no hacer nada más
    }
  } catch (error) {
    // ✅ SEGURIDAD: Método 2: Object.defineProperty como fallback seguro
    try {
      Object.defineProperty(window, 'SystemEventManager', {
        value: SystemEventManager,
        writable: true,
        enumerable: true,
        configurable: true
      });
    } catch (defineError) {
      // ✅ SEGURIDAD: Si ambos métodos fallan, registrar advertencia pero no usar eval
      if (typeof console !== 'undefined' &amp;&amp; console.warn) {
        // eslint-disable-next-line no-console
        console.warn('[SystemEventManager] ⚠️ No se pudo exponer SystemEventManager usando métodos seguros:', defineError);
      }
    }
  }
}

// Si usas ES6 modules, descomentar:
// export { SystemEventManager };

// Si usas CommonJS, descomentar:
// module.exports = { SystemEventManager };
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a> on Thu Nov 13 2025 05:45:58 GMT+0100 (hora estándar de Europa central) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
