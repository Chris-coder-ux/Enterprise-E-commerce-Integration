<?xml version="1.0"?>
<ruleset name="Custom Project Ruleset">
    <description>
        Reglas personalizadas que extienden PSR-12,
        detectan malas pr치cticas (funciones prohibidas, hardcode, TODOs),
        y refuerzan consistencia en el c칩digo.
    </description>

    <!-- Extender un est치ndar base -->
    <rule ref="PSR12"/>

    <!-- Excluir carpetas irrelevantes -->
    <exclude-pattern>*/vendor/*</exclude-pattern>
    <exclude-pattern>*/node_modules/*</exclude-pattern>
    <exclude-pattern>*/tests/*</exclude-pattern>
    <exclude-pattern>*/backups/*</exclude-pattern>
    <exclude-pattern>*/logs/*</exclude-pattern>

    <!-- Reglas contra funciones prohibidas -->
    <rule ref="Generic.PHP.ForbiddenFunctions">
        <properties>
            <property name="forbiddenFunctions" type="array">
                <element key="die" value="use exit"/>
                <element key="print" value="use echo"/>
                <element key="var_dump" value="use proper logging"/>
                <element key="print_r" value="use var_export or proper logging"/>
                <element key="mysql_query" value="use PDO or prepared statements"/>
                <element key="mysql_connect" value="use PDO or mysqli"/>
                <element key="mysql_real_escape_string" value="use prepared statements"/>
            </property>
        </properties>
    </rule>

    <!-- Reglas adicionales -->
    <rule ref="Generic.Files.OneClassPerFile"/>
    <rule ref="Generic.PHP.LowerCaseConstant"/>

    <!-- TODO como warning (no rompe el an치lisis) -->
    <rule ref="Generic.Commenting.Todo">
        <severity>5</severity> <!-- warning -->
    </rule>

    <!-- Reglas de complejidad -->
    <rule ref="Generic.Metrics.CyclomaticComplexity">
        <properties>
            <property name="complexity" value="15"/>
            <property name="absoluteComplexity" value="25"/>
        </properties>
    </rule>

    <rule ref="Generic.Metrics.NestingLevel">
        <properties>
            <property name="nestingLevel" value="5"/>
            <property name="absoluteNestingLevel" value="8"/>
        </properties>
    </rule>

    <!-- Sniffer custom para "magic numbers" y "strings hardcodeados" -->
    <!-- (debes crear un sniffer propio en tu proyecto, ej: Custom/Sniffs/CodeAnalysis/MagicNumbersSniff.php) -->
    <rule ref="Custom.CodeAnalysis.MagicNumbers"/>
    <rule ref="Custom.CodeAnalysis.HardcodedStrings"/>
</ruleset>
